<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<!-- 2023-01-02 一 22:43 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>emacs 配置总结</title>
<meta name="author" content="[[https://xiliuya.github.io/][xiliuya]]" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="/assets/org.css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">emacs 配置总结</h1>
<div id="table-of-contents" role="doc-toc">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org799a0bd">1. emacs</a>
<ul>
<li><a href="#org3c7f428">1.1. org-mode</a>
<ul>
<li><a href="#org89c466f">1.1.1. 配置 org-protocol</a>
<ul>
<li><a href="#orgd3dc5b9">配置 linux xdg</a></li>
</ul>
</li>
<li><a href="#orge21ccea">1.1.2. 配置org 导出makedown</a></li>
<li><a href="#org6337403">1.1.3. 配置 org-roam 日志模板</a>
<ul>
<li><a href="#orged138b9">配合 yas 使用模板</a></li>
</ul>
</li>
<li><a href="#orgc70b1b1">1.1.4. 配置 org-roam 关联笔记</a>
<ul>
<li><a href="#org0a79415">基本使用</a></li>
<li><a href="#org3967083">功能理解</a></li>
</ul>
</li>
<li><a href="#org4319bb7">1.1.5. org-roam 添加快捷键</a></li>
<li><a href="#org05f5e5d">1.1.6. 配置 org-modern-mode</a></li>
<li><a href="#orga79f7e4">1.1.7. 配置org-mode 导出样式</a></li>
<li><a href="#orge4315b1">1.1.8. 配置 org-mode 导出头</a></li>
<li><a href="#org0cbf03c">1.1.9. 配置 emacs org-download</a></li>
<li><a href="#org350e1c5">1.1.10. 配置 mpv 插件</a></li>
<li><a href="#org2b6edd8">1.1.11. 配置 org-mpv-notes</a>
<ul>
<li><a href="#org9133ea1">mpv</a></li>
<li><a href="#org7b0cc9d">开启会自动打开 mpv</a></li>
</ul>
</li>
<li><a href="#orgc412962">1.1.12. 配置 org 使用 prose-mode</a></li>
<li><a href="#orgabcecc9">1.1.13. 配置 org 任务管理颜色</a></li>
<li><a href="#orgc7cf936">1.1.14. 配置 org-transclusion</a></li>
<li><a href="#org241d547">1.1.15. 使用 org-transclusion</a>
<ul>
<li><a href="#org7dea2a9">链接头</a></li>
<li><a href="#orgb8be6b9">基本操作</a></li>
</ul>
</li>
<li><a href="#orgc7ffd68">1.1.16. 转换 org-roam 链接为 org-transclude 嵌入块</a></li>
<li><a href="#org9931155">1.1.17. org-mode 中文表格显示优化</a></li>
</ul>
</li>
<li><a href="#org478bae0">1.2. evil</a>
<ul>
<li><a href="#org076e87d">1.2.1. 配置evil jk 返回正常模式</a>
<ul>
<li><a href="#org8d15469">安装 evil-escape</a></li>
<li><a href="#orgfa4b67a">配置 evil-escape</a></li>
</ul>
</li>
<li><a href="#orgc708744">1.2.2. 配置evil 正常模式下 org TAB</a></li>
<li><a href="#orgcbb24ba">1.2.3. 配置 evil 插入模式快捷键</a></li>
<li><a href="#org2456588">1.2.4. 配置 evil-ex 自定义 cmd</a></li>
</ul>
</li>
<li><a href="#orgce90de3">1.3. auto-insert</a>
<ul>
<li><a href="#orgee61b0f">1.3.1. 配置auto-insert模板</a></li>
<li><a href="#org8bdd638">1.3.2. 优化 auto-insert</a></li>
</ul>
</li>
<li><a href="#org5791af1">1.4. yasnippet</a>
<ul>
<li><a href="#org2f11502">1.4.1. 配置yasnippet</a>
<ul>
<li><a href="#org5adb0e8">配置文件</a></li>
<li><a href="#orgb1ca670">新建一个模板.</a></li>
<li><a href="#org847420a">复制模板</a></li>
</ul>
</li>
<li><a href="#org2d9acb5">1.4.2. yas 快捷添加 org-src 代码块</a></li>
<li><a href="#orgde7d3a2">1.4.3. 调整 yasnippet 模板</a></li>
<li><a href="#orgad67e9e">1.4.4. 修复 prog-mode 下 yas 功能</a>
<ul>
<li><a href="#org7f821fe">解决方案</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2317b00">1.5. eglot</a>
<ul>
<li><a href="#org7d5d2be">1.5.1. 将 eglot 加入配置使其打开c文件后启动</a></li>
<li><a href="#org9c1f415">1.5.2. 查看使用eglot</a></li>
<li><a href="#org89c3f75">1.5.3. 重新配置eglot</a></li>
<li><a href="#org8a58975">1.5.4. 当打开el 文件后eglot 报错</a></li>
<li><a href="#orga2022a1">1.5.5. 配置 eglot 快捷键</a></li>
</ul>
</li>
<li><a href="#orgfd3a012">1.6. erc</a>
<ul>
<li><a href="#org71e21c3">1.6.1. 配置 erc 使用</a></li>
</ul>
</li>
<li><a href="#orgabc3072">1.7. sdcv</a>
<ul>
<li><a href="#org4458146">1.7.1. 配置 espeak 朗读</a>
<ul>
<li><a href="#orgbd52f1a">修改配置</a></li>
<li><a href="#orgafbb397">实际分析</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgaeff2e1">1.8. pyim</a>
<ul>
<li><a href="#org610008b">1.8.1. 使用pyim 并体验</a></li>
<li><a href="#org9799915">1.8.2. 修改 pyim 的选词框</a></li>
<li><a href="#org1b35bdc">1.8.3. 修复 pyim 在 prog-mode 下的bug</a></li>
</ul>
</li>
<li><a href="#org7658174">1.9. EAF</a>
<ul>
<li><a href="#orgd06d8d1">1.9.1. CANCELED 尝试使用 EAF</a></li>
</ul>
</li>
<li><a href="#org7c57baa">1.10. 优化</a>
<ul>
<li><a href="#org51e7431">1.10.1. CANCELED 优化 emacs 启动时间</a>
<ul>
<li><a href="#org3afde77">查看 <code>benchmarking</code> 信息</a></li>
<li><a href="#orgaae0346">问题</a></li>
<li><a href="#orgce72347">优化</a></li>
</ul>
</li>
<li><a href="#org904270d">1.10.2. 配置 emacs 窗口录制 GIF</a>
<ul>
<li><a href="#orgde34049">添加 shell 脚本</a></li>
<li><a href="#orge6d784b">配置快捷键</a></li>
</ul>
</li>
<li><a href="#orge13a553">1.10.3. 尝试其他 gif 方案</a>
<ul>
<li><a href="#org0484a0f">使用截图脚本截取</a></li>
<li><a href="#org3bd2d7f">使用录制屏幕截取</a></li>
</ul>
</li>
<li><a href="#orga22eb07">1.10.4. 配置 编译命令</a>
<ul>
<li><a href="#org0cd499b">配置编译成功后,隐藏弹窗:</a></li>
<li><a href="#org0c152b3">配置 c-mode 编译命令</a></li>
</ul>
</li>
<li><a href="#org6e7218c">1.10.5. 将 buffer 内容复制到缓存buffer内</a></li>
</ul>
</li>
<li><a href="#org2ce56cb">1.11. 修复</a>
<ul>
<li><a href="#org0a324ce">1.11.1. 修复 flyspell-mode 报错 Can’t find Hunspell dictionary</a></li>
<li><a href="#org2bc2623">1.11.2. 修复 org 模式下的代码执行</a></li>
<li><a href="#org12ec72f">1.11.3. 修复 org-mode 以外的 evil-tab</a></li>
<li><a href="#org8cdabdf">1.11.4. 修复 prog-mode 下 yas 功能</a>
<ul>
<li><a href="#org835894b">解决方案</a></li>
</ul>
</li>
<li><a href="#org4b99cff">1.11.5. 修复 org-transclusion 报错 No content found with "id:</a></li>
<li><a href="#orgcb6e6cb">1.11.6. 修复 pyim 在 prog-mode 下的bug</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org799a0bd" class="outline-2">
<h2 id="org799a0bd"><span class="section-number-2">1.</span> emacs</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org3c7f428" class="outline-3">
<h3 id="org3c7f428"><span class="section-number-3">1.1.</span> org-mode</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org89c466f" class="outline-4">
<h4 id="org89c466f"><span class="section-number-4">1.1.1.</span> 配置 org-protocol</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
org-protocol 可以捕获外部程序的内容, 如浏览器的数据可以发送至 org-roam
配置文件:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-protocol</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
<div id="outline-container-orgd3dc5b9" class="outline-5">
<h5 id="orgd3dc5b9">配置 linux xdg</h5>
<div class="outline-text-5" id="text-orgd3dc5b9">
<p>
建立 <code>~/.local/share/applications/org-protocol.desktop</code> :
</p>
<pre class="example" id="org5cd1475">
[Desktop Entry]
Name=Org-Protocol
Exec=emacsclient %u
Icon=emacs-icon
Type=Application
Terminal=false
MimeType=x-scheme-handler/org-protocol
</pre>
<p>
配置 xdg-mime
</p>
<div class="org-src-container">
<pre class="src src-shell">xdg-mime default org-protocol.desktop x-scheme-handler/org-protocol
</pre>
</div>
<p>
测试
</p>
<div class="org-src-container">
<pre class="src src-shell">open org-protocol://roam-ref<span style="color: #70c0b1;">\?</span><span style="color: #e7c547;">template</span>=r<span style="color: #70c0b1;">\&amp;</span><span style="color: #e7c547;">ref</span>=test<span style="color: #70c0b1;">\&amp;</span><span style="color: #e7c547;">title</span>=this
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orge21ccea" class="outline-4">
<h4 id="orge21ccea"><span class="section-number-4">1.1.2.</span> 配置org 导出makedown</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
参考链接:<a href="https://www.jianshu.com/p/768a0548cb60">org 导出md</a>
在init-local.el 内添加:
</p>
<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> 'org
<span style="color: #70c0b1;">(</span>add-to-list 'org-export-backends 'md<span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org6337403" class="outline-4">
<h4 id="org6337403"><span class="section-number-4">1.1.3.</span> 配置 org-roam 日志模板</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
添加配置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-roam-dailies-capture-templates
      <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span><span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"d"</span> <span style="color: #70c0b1;">"default"</span> entry
         <span style="color: #70c0b1;">"* %?"</span>
         <span style="color: #c397d8;">:target</span> <span style="color: #b9ca4a;">(</span>file+head <span style="color: #70c0b1;">"%&lt;%Y-%m-%d&gt;.org"</span>
                            <span style="color: #70c0b1;">"#+TITLE: %&lt;%Y-%m-%d&gt;</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+AUTHOR: [[https://xiliuya.github.io/][xiliuya]]</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+EMAIL: xiliuya@163.com</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+LANGUAGE: zh-CN</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+HTML_HEAD: &lt;link rel=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">stylesheet</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;"> type=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">text/css</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;"> href=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">/assets/org.css</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">/&gt;</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+OPTIONS: todo:nil num:3 H:4 ^:nil pri:t</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+TAGS:  { &#31967;&#31957;(1) &#20945;&#21512;(2) &#19981;&#38169;(3) &#24456;&#22909;(4) &#26497;&#21697;(5) }</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+COLUMNS: %10ITEM %10PRIORITY %15TODO %65TAGS"</span>
                            <span style="color: #b9ca4a;">)</span>
         <span style="color: #c397d8;">:unnarrowed</span> t<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
<div id="outline-container-orged138b9" class="outline-5">
<h5 id="orged138b9">配合 yas 使用模板</h5>
<div class="outline-text-5" id="text-orged138b9">
<p>
新建了一个 tem 模板, 可以直接将内容补全
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">-*- mode: snippet -*-</span>
<span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">name: temp</span>
<span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">key: tem</span>
<span style="color: #969896; font-style: italic;"># </span><span style="color: #969896; font-style: italic;">--</span>
&#24037;&#20316;
** &#37197;&#32622;emacs
$<span style="color: #e7c547;">0</span>
** Lisp &#23398;&#20064;
* &#23089;&#20048;
** TODO &#30475;&#30005;&#24433; &#39064;&#26448;&#20219;&#24847;
** TODO &#27427;&#36175;&#38899;&#20048;
** TODO &#35835;&#35799;
** TODO &#30475;&#19968;&#20010;&#20219;&#24847;&#39064;&#26448;&#30340;TED&#28436;&#35762; &#24182;&#35760;&#24405;
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc70b1b1" class="outline-4">
<h4 id="orgc70b1b1"><span class="section-number-4">1.1.4.</span> 配置 org-roam 关联笔记</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
相关链接: <a href="https://www.zmonster.me/2020/06/27/org-roam-introduction.html">org-roam 配置</a>
经过翻阅官方的文档进行以下配置, 加入 <code>init-local.el</code> :
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>require-package <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>require-package <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-ui</span><span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n l"</span><span style="color: #70c0b1;">)</span>  <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-buffer-toggle</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n g"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-graph</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n i"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-node-insert</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n c"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-capture</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n j"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-dailies-capture-today</span><span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n d"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-id-get-create</span><span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-roam-directory <span style="color: #70c0b1;">"~/myday"</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-roam-node-display-template
      <span style="color: #70c0b1;">(</span>concat <span style="color: #70c0b1;">"${title:*} "</span>
              <span style="color: #e7c547;">(</span>propertize <span style="color: #70c0b1;">"${tags:10}"</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">face</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-tag</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>org-roam-db-autosync-mode<span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">If using org-roam-protocol</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-protocol</span><span style="color: #eaeaea;">)</span>


<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> find-file-visit-truename t<span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-roam-ui-sync-theme t
      org-roam-ui-follow t
      org-roam-ui-update-on-save t
      org-roam-ui-open-on-start t<span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org0a79415" class="outline-5">
<h5 id="org0a79415">基本使用</h5>
<div class="outline-text-5" id="text-org0a79415">
<p>
通过 <code>M-x org-id-get-create</code> 给现有的小标题生成一个 node id. 
通过 <code>M-x org-roam-db-sync</code> 刷新数据库. 
通过 <code>M-x org-roam-ui-mode</code> 启动一个本地服务器, 并打开一个浏览器窗口.
</p>
</div>
</div>
<div id="outline-container-org3967083" class="outline-5">
<h5 id="org3967083">功能理解</h5>
<div class="outline-text-5" id="text-org3967083">
<p>
一款酷炫的插件, 可以简单而美观的管理众多的笔记. 
基于 <code>org-mode</code> 简化新建日志的步骤. 
便于梳理笔记形成可视化图像. 
极大简化了查找笔记的时间成本. 
易于翻阅加深记忆. 
</p>
</div>
</div>
</div>


<div id="outline-container-org4319bb7" class="outline-4">
<h4 id="org4319bb7"><span class="section-number-4">1.1.5.</span> org-roam 添加快捷键</h4>
<div class="outline-text-4" id="text-1-1-5">
<p>
原先已配置了相关快捷键,
现在多加几个, 需要的键绑定
<code>org-roam-node-find</code> 与 <code>org-roam-capture</code> 区别在于打开的方式不同.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n f"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-node-find</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>global-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c n u"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-roam-ui-open</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org05f5e5d" class="outline-4">
<h4 id="org05f5e5d"><span class="section-number-4">1.1.6.</span> 配置 org-modern-mode</h4>
<div class="outline-text-4" id="text-1-1-6">
<p>
org-modern 是一个 org-mode 美化插件
通过在配置文件加入:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; org-modern</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-modern-mode</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orga79f7e4" class="outline-4">
<h4 id="orga79f7e4"><span class="section-number-4">1.1.7.</span> 配置org-mode 导出样式</h4>
<div class="outline-text-4" id="text-1-1-7">
<p>
org-mode 导出markdown 格式,
再通过jekyll 转换为html 静态页面的过程过于繁琐.
而且效果并不美观.
故而直接使用org 配置css导出html .
</p>

<p>
参考链接: <a href="https://emacs-china.org/t/org-html/1919">emacs-china</a>
官方手册相关页: <a href="https://orgmode.org/org.html#Quoting-HTML-tags">org-mode</a>
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #b9ca4a;">TITLE:</span> <span style="color: #e78c45; font-size: 140%; font-weight: bold;"><a href="https://xiliuya.github.io/">&#20027;&#39029;</a></span>
<span style="color: #969896; font-style: italic;">HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="<a href="http://gongzhitaao.org/orgcss/org.css&quot;/">http://gongzhitaao.org/orgcss/org.css"/</a>&gt;</span>
</pre>
</div>

<p>
建立yasnippet模板:
</p>
<pre class="example" id="org7254f56">
# -*- mode: snippet -*-
# name: css for html export
# key: css
# --
#+TITLE: ${1:`(file-name-base buffer-file-name)`}
#+OPTIONS: toc:nil num:3 H:4 ^:nil pri:t
#+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="http://gongzhitaao.org/orgcss/org.css"/&gt;

$0
</pre>
</div>
</div>


<div id="outline-container-orge4315b1" class="outline-4">
<h4 id="orge4315b1"><span class="section-number-4">1.1.8.</span> 配置 org-mode 导出头</h4>
<div class="outline-text-4" id="text-1-1-8">
<p>
加入配置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; html &#23548;&#20986;&#22836;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-html-head <span style="color: #70c0b1;">"&lt;link rel=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">stylesheet</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;"> type=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">text/css</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;"> href=</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">/assets/org.css</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">/&gt;"</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
隐藏 todo 需要配置 options: todo:nil
</p>
</div>
</div>


<div id="outline-container-org0cbf03c" class="outline-4">
<h4 id="org0cbf03c"><span class="section-number-4">1.1.9.</span> 配置 emacs org-download</h4>
<div class="outline-text-4" id="text-1-1-9">
<p>
参考文档: <a href="https://hsingko.github.io/post/2021/12/23/org-download/">org-mode 中愉快地嵌入图片</a>
参考大佬配置: <a href="https://emacs-china.org/t/org-download/1672/7?u=xiliuya">tumashu</a>
</p>
<ul class="org-ul">
<li>使用快捷键 <code>C-c s s</code> 进行截图插入</li>
<li>使用快捷键 <code>C-c s c</code> 进行剪贴板插入</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">org-download &#37197;&#32622;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-download</span><span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;;</span><span style="color: #969896; font-style: italic;">(setq org-download-screenshot-method "flameshot gui --raw &gt;%s")</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-download-screenshot-method <span style="color: #70c0b1;">"grim -g </span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;">$(slurp)</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">"</span><span style="color: #70c0b1;"> %s"</span><span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;;</span><span style="color: #969896; font-style: italic;">(setq org-download-method 'directory)</span>

<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#23631;&#34109;&#40664;&#35748;&#30340;&#22270;&#29255;&#20445;&#23384;, &#30452;&#25509;&#20445;&#23384;&#21040; ./images/xxx.png</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq-default</span> org-download-heading-lvl nil<span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq-default</span> org-download-image-dir <span style="color: #70c0b1;">"./images"</span><span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#23631;&#34109;&#40664;&#35748;&#30340;&#25554;&#20837;&#22836;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">dummy-org-download-annotate-function</span> <span style="color: #70c0b1;">(</span>link<span style="color: #70c0b1;">)</span>
  <span style="color: #c397d8;">""</span> <span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-download-annotate-function
      <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">dummy-org-download-annotate-function</span><span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#21462;&#28040;&#40664;&#35748;&#30340;&#26174;&#31034;&#22270;&#29255;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-download-display-inline-images nil<span style="color: #eaeaea;">)</span>

<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#23450;&#20041;&#24555;&#25463;&#38190;</span>
<span style="color: #eaeaea;">(</span>define-key org-mode-map <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c s s"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">org-download-screenshot</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>define-key org-mode-map <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"C-c s c"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">org-download-clipboard</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>



<div id="outline-container-org350e1c5" class="outline-4">
<h4 id="org350e1c5"><span class="section-number-4">1.1.10.</span> 配置 mpv 插件</h4>
<div class="outline-text-4" id="text-1-1-10">
<p>
是一个 nognu 的包
可以在 emacs 调用命令
以窗口的形式播放视频.
</p>
</div>
</div>


<div id="outline-container-org2b6edd8" class="outline-4">
<h4 id="org2b6edd8"><span class="section-number-4">1.1.11.</span> 配置 org-mpv-notes</h4>
<div class="outline-text-4" id="text-1-1-11">
<p>
安装后无需配置直接可以通过插入 <code>mpv:</code> 链接
在 org 内插入视频. (但是,只是以文件链接的形式导出)
如下所示:
<a href="/home/xiliuya/Downloads/easyHelper/革命往事.mkv">mpv</a>
<a href="/home/xiliuya/Downloads/easyHelper/西部往事BD中英双字.mp4">西部往事BD中英双字.mp4</a>
通过: <code>org-mpv-notes-insert-note</code> 插入时间戳及笔记
通过光标停在下方笔记并执行: <code>org-mpv-notes-this-timestamp</code> 插入时间戳
注意时间戳不分文件,只是跳转到对应时间.
</p>
</div>
<div id="outline-container-org9133ea1" class="outline-5">
<h5 id="org9133ea1">mpv</h5>
</div>
<div id="outline-container-org7b0cc9d" class="outline-5">
<h5 id="org7b0cc9d">开启会自动打开 mpv</h5>
<div class="outline-text-5" id="text-org7b0cc9d">
<p>
通过在配置文件内加入:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; org-mpv-mode</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-mpv-notes</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">define-minor-mode</span> <span style="color: #e78c45;">org-mpv-notes</span>
    <span style="color: #c397d8;">"Org minor mode for Note taking alongside audio and video.</span>
<span style="color: #c397d8;">  Uses mpv.el to control mpv process"</span>
    <span style="color: #c397d8;">:keymap</span> <span style="color: #b9ca4a;">`</span><span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n i"</span><span style="color: #7aa6da;">)</span> . mpv-insert-playback-position<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n M-i"</span><span style="color: #7aa6da;">)</span> . org-mpv-notes-insert-note<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n u"</span><span style="color: #7aa6da;">)</span> . mpv-revert-seek<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n s"</span><span style="color: #7aa6da;">)</span> . org-mpv-notes-save-screenshot<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n o"</span><span style="color: #7aa6da;">)</span> . org-mpv-notes-open<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n k"</span><span style="color: #7aa6da;">)</span> . mpv-kill<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n t"</span><span style="color: #7aa6da;">)</span> . org-mpv-notes-this-timestamp<span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>,<span style="color: #7aa6da;">(</span>kbd <span style="color: #70c0b1;">"M-n M-s"</span><span style="color: #7aa6da;">)</span> . org-mpv-notes-screenshot-ocr<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">if</span> org-mpv-notes
        <span style="color: #b9ca4a;">()</span>
      <span style="color: #b9ca4a;">(</span>mpv-kill<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-mpv-notes</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc412962" class="outline-4">
<h4 id="orgc412962"><span class="section-number-4">1.1.12.</span> 配置 org 使用 prose-mode</h4>
<div class="outline-text-4" id="text-1-1-12">
<p>
只需要 hook 到 <code>org-mode-hook</code> ,期间<a href="daily/2022-12-30.html#ID-4942307c-79ae-457d-9e8a-3acc4d516d32">修复 flyspell-mode 报错 <code>Can’t find Hunspell dictionary</code></a>
<del>当打开时,不必要的 <code>writeroom-mode</code> 干扰了使用</del>.
经过研究 <code>writeroom-mode</code> 本来就为了排除干扰,删除了 hook 建议手动启动使用
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(add-hook 'org-mode-hook 'prose-mode)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgabcecc9" class="outline-4">
<h4 id="orgabcecc9"><span class="section-number-4">1.1.13.</span> 配置 org 任务管理颜色</h4>
<div class="outline-text-4" id="text-1-1-13">
<ul class="org-ul">
<li><p>
默认配置
通过设定 <code>org-todu-keywords</code> 配置默认任务管理.加入以下配置颜色:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; todo &#39068;&#33394;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-todo-keyword-faces <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span><span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"TODO"</span> . <span style="color: #70c0b1;">"red"</span><span style="color: #e7c547;">)</span>
                               <span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"NEXT"</span> . <span style="color: #70c0b1;">"yellow"</span><span style="color: #e7c547;">)</span>
                               <span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"DONE"</span> . <span style="color: #70c0b1;">"green"</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div></li>
<li><p>
org-modern
使用 <code>org-modern</code> 时的显示. 根据备注配置无效,通过 <a href="https://github.com/minad/org-modern/issues/76">org-modern/issues/76</a> 配置颜色,颜色参考:<a href="https://www.yingyuzhijia.com/m/view.php?aid=63622#:~:text=2017%E5%B9%B47%E6%9C%8816%E6%97%A5%20-%20%E9%A2%9C%E8%89%B2%E5%BF%85%E5%A4%87%E7%9A%84%E8%8B%B1%E6%96%87%E5%8D%95%E8%AF%8D.%201.%20red%E7%BA%A2%E8%89%B2.%202.%20silver%20%E9%93%B6.,7.%20olive%E6%A9%84%E6%A6%84%E8%89%B2.%208.%20pink%E7%B2%89%E7%BA%A2%E8%89%B2.%209.%20anti%20gold%20">颜色中英文对照</a> .加入配置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; org-modern-todo &#37197;&#33394;</span>

<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> org-modern-todo-faces
      <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span><span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"TODO"</span> <span style="color: #c397d8;">:foreground</span> <span style="color: #70c0b1;">"silver"</span> <span style="color: #c397d8;">:inverse-video</span> t<span style="color: #e7c547;">)</span>
        <span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"NEXT"</span> <span style="color: #c397d8;">:foreground</span> <span style="color: #70c0b1;">"white"</span> <span style="color: #c397d8;">:inverse-video</span> t<span style="color: #e7c547;">)</span>
        <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">("DONE" :foreground "gray" :inverse-video t)</span>
        <span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"PROJECT"</span> <span style="color: #c397d8;">:foreground</span> <span style="color: #70c0b1;">"violet"</span> <span style="color: #c397d8;">:inverse-video</span> t<span style="color: #e7c547;">)</span>
        <span style="color: #e7c547;">(</span><span style="color: #70c0b1;">"CANCELLED"</span> <span style="color: #c397d8;">:foreground</span> <span style="color: #70c0b1;">"tan"</span> <span style="color: #c397d8;">:inverse-video</span> t<span style="color: #e7c547;">)</span>
        <span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>


<div id="outline-container-orgc7cf936" class="outline-4">
<h4 id="orgc7cf936"><span class="section-number-4">1.1.14.</span> 配置 org-transclusion</h4>
<div class="outline-text-4" id="text-1-1-14">
<p>
不做过多配置,只加入包 <code>require-package</code>
</p>
</div>
</div>


<div id="outline-container-org241d547" class="outline-4">
<h4 id="org241d547"><span class="section-number-4">1.1.15.</span> 使用 org-transclusion</h4>
<div class="outline-text-4" id="text-1-1-15">
</div>
<div id="outline-container-org7dea2a9" class="outline-5">
<h5 id="org7dea2a9">链接头</h5>
<div class="outline-text-5" id="text-org7dea2a9">
<p>
通过在链接前加入: <code>#+transclude:</code> 得到一个 transclude 链接.
<code>:only-contents</code> 仅嵌入内容
<code>:exclude-elements</code> 排除某些元素
<code>:src python</code> 嵌入文件到代码块
<code>:src python :rest ":session :results value"</code> 代码块额外的参数.
<code>:lines 3-5</code> 嵌入第 3-5 行
<code>:level</code> 资产价值
</p>
</div>
</div>
<div id="outline-container-orgb8be6b9" class="outline-5">
<h5 id="orgb8be6b9">基本操作</h5>
<div class="outline-text-5" id="text-orgb8be6b9">
<ul class="org-ul">
<li><code>org-transclusion-mode</code> 自动应用到当前 buffer</li>
<li><code>org-transclusion-add-all</code> 将所有 <code>#+transclude:</code> 链接转换为嵌入内容</li>
<li><code>org-transclude-add</code> 将当前链接转换为嵌入内容</li>
<li><code>org-transclude-remove</code> 取消嵌入内容的显示</li>
<li><code>org-transclude-remove-all</code> 取消当前 buffer 所有嵌入内容的显示</li>
<li><code>org-transclusion-make-from-link</code> 将光标所在的普通链接转换为 <code>#+transclude:</code> 链接并输出到 buffer 最后一行(实际上只是加了个头)</li>
<li><code>org-transclude-refresh</code> 刷新当前 buffer 所有嵌入内容的改动</li>
<li><code>org-transclude-live-sync-start</code> 进入同步嵌入内容的改动(不支持代码块)</li>
<li><code>org-transclude-live-sync-exit</code> 退出同步嵌入内容的改动</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgc7ffd68" class="outline-4">
<h4 id="orgc7ffd68"><span class="section-number-4">1.1.16.</span> 转换 org-roam 链接为 org-transclude 嵌入块</h4>
<div class="outline-text-4" id="text-1-1-16">
<p>
暂时不考虑递归,由于复制到 buffer 后仍是不可读字符.
定义如下函数:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">org &#23548;&#20986;&#21040; html , &#24182;&#23558; org-roam-node &#36716;&#25442;&#20026; org-transclude &#22359;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">xiliuya/org-roam-to-html</span> <span style="color: #70c0b1;">()</span>
  <span style="color: #c397d8;">"Export org to html covert org-roam-node to org-transclude."</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">interactive</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>goto-char <span style="color: #e7c547;">(</span>point-min<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">while</span> <span style="color: #e7c547;">(</span>search-forward <span style="color: #70c0b1;">"[[id:"</span> nil t<span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">progn</span> <span style="color: #b9ca4a;">(</span>replace-match <span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+transclude: [[id:"</span><span style="color: #b9ca4a;">)</span>
           <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(org-transclusion-add)</span>
           <span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>org-transclusion-add-all<span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>org-html-export-to-html<span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>org-transclusion-remove-all<span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>goto-char <span style="color: #e7c547;">(</span>point-min<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>sit-for 1<span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">while</span> <span style="color: #e7c547;">(</span>search-forward <span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;">#+transclude: [[id:"</span> nil t<span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span>replace-match <span style="color: #70c0b1;">"[[id:"</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(xiliuya/org-roam-to-html)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org9931155" class="outline-4">
<h4 id="org9931155"><span class="section-number-4">1.1.17.</span> org-mode 中文表格显示优化</h4>
<div class="outline-text-4" id="text-1-1-17">
<p>
通过使用 <code>valign-mode</code> 自动对齐字体,暂时不加入 hook
</p>
</div>
</div>
</div>
<div id="outline-container-org478bae0" class="outline-3">
<h3 id="org478bae0"><span class="section-number-3">1.2.</span> evil</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org076e87d" class="outline-4">
<h4 id="org076e87d"><span class="section-number-4">1.2.1.</span> 配置evil jk 返回正常模式</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
vi/ vim/ evil 自带快捷键: <b>C-[</b> . 
可以从 <b>插入模式</b> 切换回 <b>正常模式</b> . 
但是有些不便. 
简单的配置键绑定:
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #eaeaea;">(</span>local-set-key <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"jk"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">evil-normal-state</span><span style="color: #eaeaea;">)</span><span style="color: #d54e53;">)</span>
</pre>
</div>
<p>
可以在当前buffer 执行 <b>C-x C-e</b> 后使用. 
但无法在add-hook 中使用,而global-set-key 不支持(kbd "jk"). 
通过论坛, 查找到了方案: <a href="https://emacs-china.org/t/evil-evil-escape-god-mode-evil-god-state/18132">emacs-china</a>. 
可以用 evil-escape 插件实现. 
</p>
</div>
<div id="outline-container-org8d15469" class="outline-5">
<h5 id="org8d15469">安装 evil-escape</h5>
<div class="outline-text-5" id="text-org8d15469">
<pre class="example">
M-x package-install RET evil-escape RET
</pre>
</div>
</div>
<div id="outline-container-orgfa4b67a" class="outline-5">
<h5 id="orgfa4b67a">配置 evil-escape</h5>
<div class="outline-text-5" id="text-orgfa4b67a">
<p>
加入配置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">evil</span>
  <span style="color: #70c0b1;">(</span>evil-escape-mode<span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq-default</span> evil-escape-key-sequence <span style="color: #70c0b1;">"jk"</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq-default</span> evil-escape-delay 0.2<span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orgc708744" class="outline-4">
<h4 id="orgc708744"><span class="section-number-4">1.2.2.</span> 配置evil 正常模式下 org TAB</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622;org-mode &#19979;&#27491;&#24120;&#27169;&#24335;&#30340; tab &#20999;&#25442;</span>
<span style="color: #eaeaea;">(</span>define-key evil-normal-state-map <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;tab&gt;"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">org-cycle</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgcbb24ba" class="outline-4">
<h4 id="orgcbb24ba"><span class="section-number-4">1.2.3.</span> 配置 evil 插入模式快捷键</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
参照论坛大佬配置:
参考链接: <a href="https://emacs-china.org/t/topic/5241/7?u=xiliuya">evil 键绑定调整</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">maple/define-key</span> <span style="color: #70c0b1;">(</span>keymap key def <span style="color: #7aa6da;">&amp;rest</span> bindings<span style="color: #70c0b1;">)</span>
  <span style="color: #c397d8;">"Define multi keybind with KEYMAP KEY DEF BINDINGS."</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">interactive</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">while</span> key
    <span style="color: #e7c547;">(</span>define-key keymap key def<span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">setq</span> key <span style="color: #b9ca4a;">(</span><span style="color: #b9ca4a;">pop</span> bindings<span style="color: #b9ca4a;">)</span>
          def <span style="color: #b9ca4a;">(</span><span style="color: #b9ca4a;">pop</span> bindings<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span>maple/define-key evil-insert-state-map
                  <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"M-h"</span><span style="color: #70c0b1;">)</span> <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;left&gt;"</span><span style="color: #70c0b1;">)</span>
                  <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"M-l"</span><span style="color: #70c0b1;">)</span> <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;right&gt;"</span><span style="color: #70c0b1;">)</span>
                  <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"M-j"</span><span style="color: #70c0b1;">)</span> <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;down&gt;"</span><span style="color: #70c0b1;">)</span>
                  <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"M-k"</span><span style="color: #70c0b1;">)</span> <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;up&gt;"</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
为了与 vim 一致使用上述绑定. 
同时因为pyim 绑定与 <code>M-j</code> 冲突已经换为 <code>M-'</code>
</p>
</div>
</div>


<div id="outline-container-org2456588" class="outline-4">
<h4 id="org2456588"><span class="section-number-4">1.2.4.</span> 配置 evil-ex 自定义 cmd</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
可以通过 evil-ex 定义一个在命令模式下执行的命令:
</p>
<ul class="org-ul">
<li><p>
使用 <code>:k</code> 调用 <code>kill-this-buffer</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">evil-ex-define-cmd</span> <span style="color: #70c0b1;">"k[illbuffer]"</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">kill-this-buffer</span><span style="color: #eaeaea;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgce90de3" class="outline-3">
<h3 id="orgce90de3"><span class="section-number-3">1.3.</span> auto-insert</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orgee61b0f" class="outline-4">
<h4 id="orgee61b0f"><span class="section-number-4">1.3.1.</span> 配置auto-insert模板</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
参考链接: <a href="https://github.com/lujun9972/emacs-document/blob/master/emacs-common/%E8%AE%A9Emacs%E4%B8%BA%E4%BD%A0%E8%87%AA%E5%8A%A8%E6%8F%92%E5%85%A5%E5%86%85%E5%AE%B9(Emacs%E6%A8%A1%E6%9D%BF%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97).org">Emacs 模板</a>
经过对比发现emacswiki 较为清晰易于使用
链接: <a href="https://www.emacswiki.org/emacs/AutoInsertMode">autoinsert emacswiki</a>
使用 github 上找到的模板:
模板链接: <a href="https://github.com/jaypei/exz-conf/tree/master/emacsconf/emacs.d/templates">jaypei/exz-conf</a>
通过在 <i>init-local.el</i> 加入:
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#20351;&#29992;auto-insert</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">find-file-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">auto-insert</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">find-file-hook</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">yas-minor-mode</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> user-full-name <span style="color: #70c0b1;">"xiliuya"</span><span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">(auto-insert-mode 1)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">my/autoinsert-yas-expand</span><span style="color: #70c0b1;">()</span>
  <span style="color: #c397d8;">"Replace text in yasnippet template."</span>
  <span style="color: #70c0b1;">(</span>yas-expand-snippet <span style="color: #e7c547;">(</span>buffer-string<span style="color: #e7c547;">)</span> <span style="color: #e7c547;">(</span>point-min<span style="color: #e7c547;">)</span> <span style="color: #e7c547;">(</span>point-max<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>custom-set-variables
 <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span>auto-insert <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">other</span><span style="color: #70c0b1;">)</span>
 <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span>auto-insert-directory <span style="color: #70c0b1;">"~/.emacs.d/templates/"</span><span style="color: #70c0b1;">)</span>
 <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span>auto-insert-alist <span style="color: #b9ca4a;">'</span><span style="color: #e7c547;">(</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">(</span><span style="color: #70c0b1;">[Hh]</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">|</span><span style="color: #70c0b1;">hh</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">|</span><span style="color: #70c0b1;">hpp</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">)</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"C / C++ header"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.h"</span> c++-mode my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">(</span><span style="color: #70c0b1;">[cC]</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">|</span><span style="color: #70c0b1;">cc</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">|</span><span style="color: #70c0b1;">cpp</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #c397d8;">)</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"C++ source"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.c"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.rs</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Rust source"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.rs"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.sh</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Shell script"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.sh"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.el</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span> . <span style="color: #70c0b1;">"Emacs Lisp"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.el"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.pl</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Perl script"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.pl"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.pm</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Perl module"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.pm"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.py</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Python script"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.py"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.go</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Go source"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.go"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"[mM]akefile</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"Makefile"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"Makefile"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span>
                       <span style="color: #b9ca4a;">(</span><span style="color: #7aa6da;">(</span><span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.tex</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">'"</span>
                         . <span style="color: #70c0b1;">"TeX/LaTeX"</span><span style="color: #7aa6da;">)</span>
                        . <span style="color: #7aa6da;">[</span><span style="color: #70c0b1;">"template.tex"</span> my/autoinsert-yas-expand<span style="color: #7aa6da;">]</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
<del>由于 purcell 配置里go 并没有默认配置 所以go 的模板配置不生效</del>
通过加入 <code>(add-hook 'find-file-hook #'yas-minor-mode)</code> 解决
</p>
</div>
</div>



<div id="outline-container-org8bdd638" class="outline-4">
<h4 id="org8bdd638"><span class="section-number-4">1.3.2.</span> 优化 auto-insert</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
由于自动插入的 email 地址不正确.通过以下加入设置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> user-mail-address <span style="color: #70c0b1;">"xiliuya@163.com"</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5791af1" class="outline-3">
<h3 id="org5791af1"><span class="section-number-3">1.4.</span> yasnippet</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org2f11502" class="outline-4">
<h4 id="org2f11502"><span class="section-number-4">1.4.1.</span> 配置yasnippet</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
yasnippt 是一个代码模板系统. 
可以和eglot 配合使用. 
配置好可以极大加快代码速度. 
</p>
</div>
<div id="outline-container-org5adb0e8" class="outline-5">
<h5 id="org5adb0e8">配置文件</h5>
<div class="outline-text-5" id="text-org5adb0e8">
<p>
可以参考链接: <a href="https://github.com/joaotavora/eglot">eglot github</a> . 
在init-local.el 加入:
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">prog-mode-hook</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">yas-minor-mode</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">yasnippet</span>
  <span style="color: #70c0b1;">(</span>yas-global-mode 1<span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb1ca670" class="outline-5">
<h5 id="orgb1ca670">新建一个模板.</h5>
<div class="outline-text-5" id="text-orgb1ca670">
<p>
通过 <b>M-x yas-new-snippet</b>
例如在 c-mode 中建立了一个: 输入name 字符串后使用TAB 会变成It's xiliuya 的模板
(仅限于输入非代码时)
</p>
<pre class="example" id="orgefc000f">
# -*- mode: snippet -*-
# name:name
# key:name
# --
It's xiliuya
</pre>
</div>
</div>
<div id="outline-container-org847420a" class="outline-5">
<h5 id="org847420a">复制模板</h5>
<div class="outline-text-5" id="text-org847420a">
<p>
将 github 上的模板文件夹: <b>snippets</b> 复制到 <b>~/.emacs.d/snippets/</b> . 
模板链接 : <a href="https://github.com/yun63/emacs.d.git">yun63</a>
</p>
</div>
</div>
</div>


<div id="outline-container-org2d9acb5" class="outline-4">
<h4 id="org2d9acb5"><span class="section-number-4">1.4.2.</span> yas 快捷添加 org-src 代码块</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
使用 <code>C-c &amp; C-n</code> 定义一个新的快捷插入片段
</p>
<ul class="org-ul">
<li>src_shell key sh_</li>
<li>src_python key py_</li>
<li>src_lisp key elisp_</li>
<li>dot key dot_</li>
</ul>
</div>
</div>


<div id="outline-container-orgde7d3a2" class="outline-4">
<h4 id="orgde7d3a2"><span class="section-number-4">1.4.3.</span> 调整 yasnippet 模板</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
删除 <code>yasnippet-snippets</code> 包已有的模板
保留自定义的几个有用的模板
</p>
</div>
</div>


<div id="outline-container-orgad67e9e" class="outline-4">
<h4 id="orgad67e9e"><span class="section-number-4">1.4.4.</span> 修复 prog-mode 下 yas 功能</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
由于在沙盒内测试并无异常
经过逐个关闭 minor mode 测试后
得出冲突的模式:
</p>
<blockquote>
<p>
Symbol-Overlay minor mode
</p>
</blockquote>
<p>
已经向 <code>symbol-overlay</code> 提交 <a href="https://github.com/wolray/symbol-overlay/issues/92">issues</a>
</p>
</div>
<div id="outline-container-org7f821fe" class="outline-5">
<h5 id="org7f821fe">解决方案</h5>
<div class="outline-text-5" id="text-org7f821fe">
<p>
通过修改 <code>prog-mode-hook</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>remove-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">prog-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">symbol-overlay-mode</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org2317b00" class="outline-3">
<h3 id="org2317b00"><span class="section-number-3">1.5.</span> eglot</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org7d5d2be" class="outline-4">
<h4 id="org7d5d2be"><span class="section-number-4">1.5.1.</span> 将 eglot 加入配置使其打开c文件后启动</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
已加入init-local.el
使用 <b>(add-hook 'prog-mode-hook 'eglot-ensure)</b>
配置hook 了该模式下所有的环境
</p>
</div>
</div>


<div id="outline-container-org9c1f415" class="outline-4">
<h4 id="org9c1f415"><span class="section-number-4">1.5.2.</span> 查看使用eglot</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
通过阅读文档
官方readme:<a href="https://github.com/joaotavora/eglot"> eglot</a>
得到M-. M-, 跳转代码
当未进入插入模式时 可以使用C-] 跳转
进入后使用M-, 返回
</p>
</div>
</div>


<div id="outline-container-org89c3f75" class="outline-4">
<h4 id="org89c3f75"><span class="section-number-4">1.5.3.</span> 重新配置eglot</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
删除旧配置
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">prog-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eglot-ensure</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
eglot 依赖外部的lsp server,
所以手动配置add-hook 模式比较合适
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">python-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eglot-ensure</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">c-mode-common-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eglot-ensure</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">rust-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eglot-ensure</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>



<div id="outline-container-org8a58975" class="outline-4">
<h4 id="org8a58975"><span class="section-number-4">1.5.4.</span> 当打开el 文件后eglot 报错</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
放弃原先的pr 因为使用时会不生效 原因不明
直接使用add-hook 时 打开el 报错
el 环境已足够完善, 不需要eglot.
经过实验是由于eglot 没有找到lsp server
</p>
</div>
</div>




<div id="outline-container-orga2022a1" class="outline-4">
<h4 id="orga2022a1"><span class="section-number-4">1.5.5.</span> 配置 eglot 快捷键</h4>
<div class="outline-text-4" id="text-1-5-5">
<p>
参考链接:<a href="https://whatacold.io/blog/2022-01-22-emacs-eglot-lsp/">Eglot for Better Programming</a>
根据参考的链接结合已有配置
如 <code>flymake-goto-next-error flymake-goto-prev-error</code> .
已经分别绑定到了 <code>C-c ! n</code> 和 <code>C-c ! p</code> 了
</p>

<p>
只需要在配置中加上 <code>eglot-rename</code> 快捷键就足够了,
作为补充配置了 <code>eglot-format</code> 的快捷键. ( <i>这两个都很好玩</i> )
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eglot</span>
  <span style="color: #70c0b1;">(</span>define-key eglot-mode-map <span style="color: #e7c547;">(</span>kbd <span style="color: #70c0b1;">"C-c e r"</span><span style="color: #e7c547;">)</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">eglot-rename</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>define-key eglot-mode-map <span style="color: #e7c547;">(</span>kbd <span style="color: #70c0b1;">"C-c e f"</span><span style="color: #e7c547;">)</span> <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">eglot-format</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfd3a012" class="outline-3">
<h3 id="orgfd3a012"><span class="section-number-3">1.6.</span> erc</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org71e21c3" class="outline-4">
<h4 id="org71e21c3"><span class="section-number-4">1.6.1.</span> 配置 erc 使用</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
经过多次的粗心大意 终于按照 <a href="https://libera.chat/guides/emacs-erc">官方方案</a> 成功连到irc <del>但是好像不能正常查看消息</del> 是我太浮躁了
根据官网的教程 <code>erc-sasl</code> 下载文件并在 <code>init-local.el</code> 加入以下内容:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; erc</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">erc-backend</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">erc-sasl</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>add-to-list <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">erc-sasl-server-regexp-list</span> <span style="color: #70c0b1;">"irc</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.libera</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">\</span><span style="color: #70c0b1;">.chat"</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">erc</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">erc-login</span> <span style="color: #e7c547;">()</span>
    <span style="color: #c397d8;">"Perform user authentication at the IRC server. (PATCHED)"</span>
    <span style="color: #e7c547;">(</span>erc-log <span style="color: #b9ca4a;">(</span>format <span style="color: #70c0b1;">"login: nick: %s, user: %s %s %s :%s"</span>
                     <span style="color: #7aa6da;">(</span>erc-current-nick<span style="color: #7aa6da;">)</span>
                     <span style="color: #7aa6da;">(</span>user-login-name<span style="color: #7aa6da;">)</span>
                     <span style="color: #7aa6da;">(</span><span style="color: #b9ca4a;">or</span> erc-system-name <span style="color: #eaeaea;">(</span>system-name<span style="color: #eaeaea;">)</span><span style="color: #7aa6da;">)</span>
                     erc-session-server
                     erc-session-user-full-name<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">if</span> erc-session-password
        <span style="color: #b9ca4a;">(</span>erc-server-send <span style="color: #7aa6da;">(</span>format <span style="color: #70c0b1;">"PASS %s"</span> erc-session-password<span style="color: #7aa6da;">)</span><span style="color: #b9ca4a;">)</span>
      <span style="color: #b9ca4a;">(</span>message <span style="color: #70c0b1;">"Logging in without password"</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">when</span> <span style="color: #b9ca4a;">(</span><span style="color: #b9ca4a;">and</span> <span style="color: #7aa6da;">(</span><span style="color: #b9ca4a;">featurep</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">erc-sasl</span><span style="color: #7aa6da;">)</span> <span style="color: #7aa6da;">(</span>erc-sasl-use-sasl-p<span style="color: #7aa6da;">)</span><span style="color: #b9ca4a;">)</span>
      <span style="color: #b9ca4a;">(</span>erc-server-send <span style="color: #70c0b1;">"CAP REQ :sasl"</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span>erc-server-send <span style="color: #b9ca4a;">(</span>format <span style="color: #70c0b1;">"NICK %s"</span> <span style="color: #7aa6da;">(</span>erc-current-nick<span style="color: #7aa6da;">)</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span>erc-server-send
     <span style="color: #b9ca4a;">(</span>format <span style="color: #70c0b1;">"USER %s %s %s :%s"</span>
             <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">hacked - S.B.</span>
             <span style="color: #7aa6da;">(</span><span style="color: #b9ca4a;">if</span> erc-anonymous-login erc-email-userid <span style="color: #eaeaea;">(</span>user-login-name<span style="color: #eaeaea;">)</span><span style="color: #7aa6da;">)</span>
             <span style="color: #70c0b1;">"0"</span> <span style="color: #70c0b1;">"*"</span>
             erc-session-user-full-name<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span>erc-update-mode-line<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">setq</span> erc-autojoin-channels-alist
      <span style="color: #b9ca4a;">'</span><span style="color: #70c0b1;">(</span><span style="color: #e7c547;">(</span>Libera.Chat <span style="color: #70c0b1;">"#libera"</span> <span style="color: #70c0b1;">"#list"</span> <span style="color: #70c0b1;">"#linux"</span> <span style="color: #70c0b1;">"$emacs"</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>


<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">(erc-tls :server "irc.libera.chat" :port 6697 :nick "xiliuya"</span>
<span style="color: #969896; font-style: italic;">;;          </span><span style="color: #969896; font-style: italic;">:full-name "xiliuya"</span>
<span style="color: #969896; font-style: italic;">;;          </span><span style="color: #969896; font-style: italic;">:password "")</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgabc3072" class="outline-3">
<h3 id="orgabc3072"><span class="section-number-3">1.7.</span> sdcv</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-org4458146" class="outline-4">
<h4 id="org4458146"><span class="section-number-4">1.7.1.</span> 配置 espeak 朗读</h4>
<div class="outline-text-4" id="text-1-7-1">
</div>
<div id="outline-container-orgbd52f1a" class="outline-5">
<h5 id="orgbd52f1a">修改配置</h5>
<div class="outline-text-5" id="text-orgbd52f1a">
<p>
在 init-local.el 加入如下配置:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622;&#20462;&#22797; espeak &#20351;&#29992;&#26102;&#20986;&#29616;&#30340;&#30333;&#23631;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">sdcv</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">sdcv-search-simple</span> <span style="color: #e7c547;">(</span><span style="color: #7aa6da;">&amp;optional</span> word<span style="color: #e7c547;">)</span>
    <span style="color: #c397d8;">"search word simple translate result."</span>
    <span style="color: #e7c547;">(</span>funcall
     sdcv-popup-function
     <span style="color: #b9ca4a;">(</span>sdcv-filter
      <span style="color: #7aa6da;">(</span>shell-command-to-string
       <span style="color: #eaeaea;">(</span>mapconcat <span style="color: #b9ca4a;">#'</span><span style="color: #7aa6da;">identity</span>
                  <span style="color: #70c0b1;">(</span>cons <span style="color: #70c0b1;">"sdcv"</span> <span style="color: #e7c547;">(</span>sdcv-search-with-dictionary-args
                                <span style="color: #b9ca4a;">(</span><span style="color: #b9ca4a;">or</span> word <span style="color: #eaeaea;">(</span>sdcv-region-or-word<span style="color: #eaeaea;">)</span><span style="color: #b9ca4a;">)</span>
                                sdcv-dictionary-simple-list<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
                  <span style="color: #70c0b1;">" "</span><span style="color: #eaeaea;">)</span><span style="color: #7aa6da;">)</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>

    <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">pronounce the word (add by me)</span>
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">when</span> sdcv-word-pronounce
      <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">`</span><span style="color: #7aa6da; font-style: italic;">sleep-for</span><span style="color: #969896; font-style: italic;">', `</span><span style="color: #7aa6da; font-style: italic;">sit-for</span><span style="color: #969896; font-style: italic;">'.</span>
      <span style="color: #b9ca4a;">(</span>sit-for 0.8<span style="color: #b9ca4a;">)</span>
      <span style="color: #b9ca4a;">(</span>sdcv-pronounce-word word<span style="color: #b9ca4a;">)</span>
      <span style="color: #e7c547;">)</span>
    <span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
调试的代码:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">&#19979;&#26041;&#26159;&#35843;&#35797;&#20449;&#24687; &#19981;&#21152;&#20837;&#37197;&#32622;</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">(setq sdcv-word-pronounce 'nil)</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">(setq sdcv-word-pronounce 't)</span>

<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">(defun sdcv-search-pointer+ ()</span>
<span style="color: #969896; font-style: italic;">;;   </span><span style="color: #969896; font-style: italic;">"translate current point word.</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">and show information use tooltip.</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">but this function use a simple dictionary list."</span>
<span style="color: #969896; font-style: italic;">;;   </span><span style="color: #969896; font-style: italic;">(interactive)</span>
<span style="color: #969896; font-style: italic;">;;   </span><span style="color: #969896; font-style: italic;">(let ((word (sdcv-region-or-word)))</span>
<span style="color: #969896; font-style: italic;">;;     </span><span style="color: #969896; font-style: italic;">;; display simple translate result.</span>
<span style="color: #969896; font-style: italic;">;;     </span><span style="color: #969896; font-style: italic;">(sdcv-search-simple word)</span>
<span style="color: #969896; font-style: italic;">;;     </span><span style="color: #969896; font-style: italic;">(sit-for 1)</span>
<span style="color: #969896; font-style: italic;">;;     </span><span style="color: #969896; font-style: italic;">(sdcv-pronounce-word word)</span>
<span style="color: #969896; font-style: italic;">;;     </span><span style="color: #969896; font-style: italic;">))</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgafbb397" class="outline-5">
<h5 id="orgafbb397">实际分析</h5>
<div class="outline-text-5" id="text-orgafbb397">
<p>
由于 <code>sleep-for</code> 函数的未知原因导致, 使用 <code>sit-for</code> 可以解决
建议多看一些备注信息, 有时可以快速排查问题
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgaeff2e1" class="outline-3">
<h3 id="orgaeff2e1"><span class="section-number-3">1.8.</span> pyim</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-org610008b" class="outline-4">
<h4 id="org610008b"><span class="section-number-4">1.8.1.</span> 使用pyim 并体验</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
成功使用 并正常的输入汉字
可在终端运行正常
使用M-j 进行中英文切换
普通时先输入字母 再通过快捷键唤醒
配置了半角字符 为默认字符
</p>
</div>
</div>


<div id="outline-container-org9799915" class="outline-4">
<h4 id="org9799915"><span class="section-number-4">1.8.2.</span> 修改 pyim 的选词框</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
使用默认值就可以只需要安装 posframe 包.
配置加入
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>require-package <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">posframe</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org1b35bdc" class="outline-4">
<h4 id="org1b35bdc"><span class="section-number-4">1.8.3.</span> 修复 pyim 在 prog-mode 下的bug</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
经过测试禁用了 <code>symbol-overlay</code> 后不再出现输入框消失和输入字符出现问题了.
</p>
</div>
</div>
</div>
<div id="outline-container-org7658174" class="outline-3">
<h3 id="org7658174"><span class="section-number-3">1.9.</span> EAF</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-orgd06d8d1" class="outline-4">
<h4 id="orgd06d8d1"><span class="section-number-4">1.9.1.</span> CANCELED 尝试使用 EAF</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
经过测试没有预期的美好与简洁, 由于wayland 支持不好已经放弃使用.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>add-to-list <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">load-path</span> <span style="color: #70c0b1;">"~/.emacs.d/site-lisp/emacs-application-framework/"</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eaf</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eaf-browser</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eaf-pdf-viewer</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">eaf-demo</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org7c57baa" class="outline-3">
<h3 id="org7c57baa"><span class="section-number-3">1.10.</span> 优化</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-org51e7431" class="outline-4">
<h4 id="org51e7431"><span class="section-number-4">1.10.1.</span> CANCELED 优化 emacs 启动时间</h4>
<div class="outline-text-4" id="text-1-10-1">
</div>
<div id="outline-container-org3afde77" class="outline-5">
<h5 id="org3afde77">查看 <code>benchmarking</code> 信息</h5>
<div class="outline-text-5" id="text-org3afde77">
<p>
通过 <code>M-x sanityinc/require-time</code> 查看启动时间详情
</p>
</div>
</div>
<div id="outline-container-orgaae0346" class="outline-5">
<h5 id="orgaae0346">问题</h5>
<div class="outline-text-5" id="text-orgaae0346">
<p>
问题主要在 <code>org-mode</code> 暂时没有较好的解决方案
按照时间排序输出如下:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">start_time</th>
<th scope="col" class="org-left">Feature</th>
<th scope="col" class="org-right">Time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">83036.907</td>
<td class="org-left">ol-gnus</td>
<td class="org-right">2618.484</td>
</tr>

<tr>
<td class="org-right">83079.567</td>
<td class="org-left">gnus-sum</td>
<td class="org-right">2073.966</td>
</tr>

<tr>
<td class="org-right">83354.692</td>
<td class="org-left">gnus-group</td>
<td class="org-right">1536.641</td>
</tr>

<tr>
<td class="org-right">83401.804</td>
<td class="org-left">gnus-start</td>
<td class="org-right">1443.971</td>
</tr>

<tr>
<td class="org-right">2241.952</td>
<td class="org-left">init-local</td>
<td class="org-right">1282.597</td>
</tr>

<tr>
<td class="org-right">83490.073</td>
<td class="org-left">gnus-int</td>
<td class="org-right">910.991</td>
</tr>

<tr>
<td class="org-right">83533.981</td>
<td class="org-left">message</td>
<td class="org-right">822.331</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgce72347" class="outline-5">
<h5 id="orgce72347">优化</h5>
<div class="outline-text-5" id="text-orgce72347">
</div>
<ul class="org-ul">
<li><a id="org13fb35f"></a>init-elpa<br />
<div class="outline-text-6" id="text-org13fb35f">
<p>
修改镜像源配置内容:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">init-elpa</span>
  ...<span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622;&#28304;&#22312; init-elpa &#21152;&#36733;&#21518;&#35206;&#30422;</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>



<div id="outline-container-org904270d" class="outline-4">
<h4 id="org904270d"><span class="section-number-4">1.10.2.</span> 配置 emacs 窗口录制 GIF</h4>
<div class="outline-text-4" id="text-1-10-2">
<p>
修改相关项目 el <a href="https://github.com/Ambrevar/emacs-gif-screencast">gif-screen</a>
修改后的代码: <a href="https://github.com/xiliuya/emacs.d/blob/my-dotfile/lisp/gif-screencast.el">gif-screen-wayland</a>
</p>

<ul class="org-ul">
<li>使用快捷键 <code>&lt;f12&gt;</code> 开始录制</li>
<li>使用快捷键 <code>C-&lt;f12&gt;</code> 暂停录制</li>
<li>使用快捷键 <code>&lt;f12&gt;</code> 停止录制</li>
</ul>

<p>
由于通过 args 传递 swaymsg 字符串很长, 且会报错(已经过转义). 无法正常输出的窗口焦点坐标内容, 通过制作 shell 脚本更为通用简单
文件自动保存到 <code>~/Videos/emacs/</code> 目录下
</p>
</div>
<div id="outline-container-orgde34049" class="outline-5">
<h5 id="orgde34049">添加 shell 脚本</h5>
<div class="outline-text-5" id="text-orgde34049">
<div class="org-src-container">
<pre class="src src-shell">swaymsg -t get_tree | jq -j <span style="color: #70c0b1;">'.. | select(.type?) | select(.focused).rect | "\(.x),\(.y) \(.width)x\(.height)"'</span>
</pre>
</div>
<p>
链接:
</p>
<div class="org-src-container">
<pre class="src src-shell">ln -s /home/xiliuya/myday/daily/swayfocuse.sh ~/.local/bin/swayfocuse
</pre>
</div>
<div class="org-src-container">
<pre class="src src-shell">grim -g <span style="color: #70c0b1;">"$(swayfocuse)"</span> $<span style="color: #e7c547;">*</span>
</pre>
</div>
<p>
链接:
</p>
<div class="org-src-container">
<pre class="src src-shell">ln -s /home/xiliuya/myday/daily/grimfocuse ~/.local/bin/grimfocuse
</pre>
</div>
</div>
</div>
<div id="outline-container-orge6d784b" class="outline-5">
<h5 id="orge6d784b">配置快捷键</h5>
<div class="outline-text-5" id="text-orge6d784b">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; gif &#25130;&#22270;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">require</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">gif-screencast</span><span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">with-eval-after-load</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">gif-screencast</span>
  <span style="color: #70c0b1;">(</span>define-key gif-screencast-mode-map <span style="color: #e7c547;">(</span>kbd <span style="color: #70c0b1;">"C-&lt;f12&gt;"</span><span style="color: #e7c547;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">gif-screencast-toggle-pause</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>define-key gif-screencast-mode-map <span style="color: #e7c547;">(</span>kbd <span style="color: #70c0b1;">"&lt;f12&gt;"</span><span style="color: #e7c547;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">gif-screencast-stop</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>global-set-key <span style="color: #e7c547;">(</span>kbd <span style="color: #70c0b1;">"&lt;f12&gt;"</span><span style="color: #e7c547;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">gif-screencast</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orge13a553" class="outline-4">
<h4 id="orge13a553"><span class="section-number-4">1.10.3.</span> 尝试其他 gif 方案</h4>
<div class="outline-text-4" id="text-1-10-3">
<p>
我想我 <del>鬼迷心窍了</del> 竟然执着于用复杂的方法实现简单的功能
感觉到了讽刺, 不过我也得到了一个,用不同的方式去实现另一件事情的方法.
原先方法的劣势:
</p>
<ul class="org-ul">
<li>由于记录依靠 pre-commond-hook= 所以某些(im)的操作无法捕获</li>
<li>没有完全的记录所有画面, 导致显示的操作与录制后有所区别</li>
</ul>
<p>
暂时不换, 经过了测试, 使用原先的方式稍微要优于以下的两种:
</p>
<ul class="org-ul">
<li>体积大小的原因同等时间 <code>gif</code> 大小 <code>20MB/300KB</code></li>
<li>gif 不如直接录屏的 mp4</li>
</ul>
<p>
旧的方式 : <a href="daily/2022-12-20.html#ID-f3a6b17a-7297-419e-8af7-346ddc109609">配置 emacs 窗口录制 GIF</a>
</p>
</div>
<div id="outline-container-org0484a0f" class="outline-5">
<h5 id="org0484a0f">使用截图脚本截取</h5>
<div class="outline-text-5" id="text-org0484a0f">
<p>
由于并不好用用作参考不做研究.
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #e7c547;">i</span>=0
<span style="color: #b9ca4a;">for</span> <span style="color: #eaeaea;">(</span><span style="color: #70c0b1;">(</span><span style="color: #e7c547;">i</span>=0 ;i&lt;1000;i++<span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
<span style="color: #b9ca4a;">do</span>
    <span style="color: #b9ca4a;">if</span> <span style="color: #eaeaea;">(</span><span style="color: #70c0b1;">(</span> $<span style="color: #e7c547;">i</span> &lt; 10 <span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>;<span style="color: #b9ca4a;">then</span>
        swayvkshot -o <span style="color: #70c0b1;">"0"</span>$<span style="color: #e7c547;">i</span>.png -g <span style="color: #70c0b1;">"$(swayfocuse)"</span>
    <span style="color: #b9ca4a;">else</span>
        swayvkshot -o $<span style="color: #e7c547;">i</span>.png -g  <span style="color: #70c0b1;">"$(swayfocuse)"</span>
    <span style="color: #b9ca4a;">fi</span>
<span style="color: #b9ca4a;">done</span>
<span style="color: #c397d8;">echo</span> <span style="color: #70c0b1;">"done"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3bd2d7f" class="outline-5">
<h5 id="org3bd2d7f">使用录制屏幕截取</h5>
<div class="outline-text-5" id="text-org3bd2d7f">
<p>
经过了实验生成的文件会很大,不太建议使用
启动录制:
</p>
<div class="org-src-container">
<pre class="src src-shell">wf-recorder -g <span style="color: #70c0b1;">"$(swayfocuse)"</span> -f /tmp/tmp.mp4 &amp;
</pre>
</div>
<p>
关闭录制:
</p>
<div class="org-src-container">
<pre class="src src-shell">pkill --signal SIGINT wf-recorder &amp;&amp;
    sleep 0.5 &amp;&amp;
    <span style="color: #e7c547;">TIME_N</span>=<span style="color: #70c0b1;">"$(date "+%y%m%d_%H%M%S")"</span>
ffmpeg -i /tmp/tmp.mp4 ~/Videos/out_$<span style="color: #eaeaea;">{</span><span style="color: #e7c547;">TIME_N</span><span style="color: #eaeaea;">}</span>.gif &amp;&amp;
    gifsicle --optimize=3 -b ~/Videos/out_$<span style="color: #eaeaea;">{</span><span style="color: #e7c547;">TIME_N</span><span style="color: #eaeaea;">}</span>.gif &amp;&amp;
    <span style="color: #b9ca4a;">if</span> <span style="color: #eaeaea;">[</span> -f /tmp/tmp.mp4 <span style="color: #eaeaea;">]</span>; <span style="color: #b9ca4a;">then</span>
        <span style="color: #c397d8;">echo</span> <span style="color: #70c0b1;">"&#21024;&#38500; /tmp/tmp.mp4 &#25991;&#20214;"</span>
        rm -f /tmp/tmp.mp4
    <span style="color: #b9ca4a;">else</span>
        <span style="color: #c397d8;">echo</span> <span style="color: #70c0b1;">"&#25991;&#20214;&#19981;&#23384;&#22312;"</span>
    <span style="color: #b9ca4a;">fi</span>
</pre>
</div>
<p>
配置软链接:
</p>
<div class="org-src-container">
<pre class="src src-shell">ln -s /home/xiliuya/myday/daily/recorder_start.sh ~/.local/bin/gif_start
ln -s /home/xiliuya/myday/daily/recorder_stop.sh ~/.local/bin/gif_stop
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orga22eb07" class="outline-4">
<h4 id="orga22eb07"><span class="section-number-4">1.10.4.</span> 配置 编译命令</h4>
<div class="outline-text-4" id="text-1-10-4">
</div>

<div id="outline-container-org0cd499b" class="outline-5">
<h5 id="org0cd499b">配置编译成功后,隐藏弹窗:</h5>
<div class="outline-text-5" id="text-org0cd499b">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622;&#32534;&#35793;&#25104;&#21151;&#21518;,&#38544;&#34255;&#24377;&#31383;</span>
<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">notify-compilation-result</span><span style="color: #70c0b1;">(</span>buffer msg<span style="color: #70c0b1;">)</span>
  <span style="color: #c397d8;">"Notify that the compilation is finished,</span>
<span style="color: #c397d8;">  close the *compilation* buffer if the compilation is successful,</span>
<span style="color: #c397d8;">  and set the focus back to Emacs frame"</span>

  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">if</span> <span style="color: #e7c547;">(</span>string-match <span style="color: #70c0b1;">"^finished"</span> msg<span style="color: #e7c547;">)</span>
      <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">progn</span>
        <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(delete-windows-on buffer)</span>
        <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(bury-buffer buffer)</span>
        <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(kill-buffer buffer)</span>
        <span style="color: #b9ca4a;">(</span>switch-to-prev-buffer <span style="color: #7aa6da;">(</span>xiliuya/find-buffer <span style="color: #eaeaea;">(</span>window-list<span style="color: #eaeaea;">)</span> <span style="color: #70c0b1;">"*compilation*"</span><span style="color: #7aa6da;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">bury</span> <span style="color: #b9ca4a;">)</span>
        <span style="color: #b9ca4a;">(</span>tooltip-show <span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;"> Compilation Successful :-) </span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;"> "</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #e7c547;">(</span>tooltip-show <span style="color: #70c0b1;">"</span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;"> Compilation Failed :-( </span><span style="color: #e7c547;">\</span><span style="color: #c397d8;">n</span><span style="color: #70c0b1;"> "</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>

<span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">xiliuya/find-buffer</span> <span style="color: #70c0b1;">(</span>w-list str<span style="color: #70c0b1;">)</span>
  <span style="color: #c397d8;">"Find a window-list buffer with full buffer name"</span>

  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">if</span> <span style="color: #e7c547;">(</span>null w-list<span style="color: #e7c547;">)</span>
      nil
    <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">if</span> <span style="color: #b9ca4a;">(</span>string-match <span style="color: #7aa6da;">(</span>buffer-name <span style="color: #eaeaea;">(</span>window-buffer <span style="color: #70c0b1;">(</span>car w-list<span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span><span style="color: #7aa6da;">)</span> str<span style="color: #b9ca4a;">)</span>
        <span style="color: #b9ca4a;">(</span>car w-list<span style="color: #b9ca4a;">)</span>
      <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(window-buffer (car w-list))</span>
      <span style="color: #b9ca4a;">(</span>xiliuya/find-buffer <span style="color: #7aa6da;">(</span>cdr w-list<span style="color: #7aa6da;">)</span> str<span style="color: #b9ca4a;">)</span>
      <span style="color: #e7c547;">)</span>
    <span style="color: #70c0b1;">)</span>
  <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(setq w (car w-list))</span>
  <span style="color: #eaeaea;">)</span>
<span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(xiliuya/find-buffer (window-list) "*scratch*")</span>
<span style="color: #eaeaea;">(</span>add-to-list <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">compilation-finish-functions</span>
             <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">notify-compilation-result</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c152b3" class="outline-5">
<h5 id="org0c152b3">配置 c-mode 编译命令</h5>
<div class="outline-text-5" id="text-org0c152b3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #969896; font-style: italic;">;;; </span><span style="color: #969896; font-style: italic;">&#37197;&#32622; c-mode &#32534;&#35793;&#21629;&#20196;</span>
<span style="color: #eaeaea;">(</span>add-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">c-mode-hook</span>
          <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">lambda</span> <span style="color: #e7c547;">()</span>
            <span style="color: #e7c547;">(</span><span style="color: #b9ca4a;">unless</span> <span style="color: #b9ca4a;">(</span>file-exists-p <span style="color: #70c0b1;">"Makefile"</span><span style="color: #b9ca4a;">)</span>
              <span style="color: #b9ca4a;">(</span>set <span style="color: #7aa6da;">(</span>make-local-variable <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">compile-command</span><span style="color: #7aa6da;">)</span>
                   <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">emulate make's .c.o implicit pattern rule, but with</span>
                   <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">different defaults for the CC, CPPFLAGS, and CFLAGS</span>
                   <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">variables:</span>
                   <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">$(CC) -c -o $@ $(CPPFLAGS) $(CFLAGS) $&lt;</span>
                   <span style="color: #7aa6da;">(</span><span style="color: #b9ca4a;">let</span> <span style="color: #eaeaea;">(</span><span style="color: #70c0b1;">(</span>file <span style="color: #e7c547;">(</span>file-name-nondirectory buffer-file-name<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
                     <span style="color: #eaeaea;">(</span>format <span style="color: #70c0b1;">"%s -o %s %s %s %s"</span>
                             <span style="color: #969896; font-style: italic;">;;</span><span style="color: #969896; font-style: italic;">(format "%s -c -o %s.o %s %s %s"</span>
                             <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">or</span> <span style="color: #e7c547;">(</span>getenv <span style="color: #70c0b1;">"CC"</span><span style="color: #e7c547;">)</span> <span style="color: #70c0b1;">"gcc"</span><span style="color: #70c0b1;">)</span>
                             <span style="color: #70c0b1;">(</span>file-name-sans-extension file<span style="color: #70c0b1;">)</span>
                             <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">or</span> <span style="color: #e7c547;">(</span>getenv <span style="color: #70c0b1;">"CPPFLAGS"</span><span style="color: #e7c547;">)</span> <span style="color: #70c0b1;">"-DDEBUG=9"</span><span style="color: #70c0b1;">)</span>
                             <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">or</span> <span style="color: #e7c547;">(</span>getenv <span style="color: #70c0b1;">"CFLAGS"</span><span style="color: #e7c547;">)</span> <span style="color: #70c0b1;">"-ansi -pedantic -Wall -g"</span><span style="color: #70c0b1;">)</span>
                             file<span style="color: #eaeaea;">)</span><span style="color: #7aa6da;">)</span><span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org6e7218c" class="outline-4">
<h4 id="org6e7218c"><span class="section-number-4">1.10.5.</span> 将 buffer 内容复制到缓存buffer内</h4>
<div class="outline-text-4" id="text-1-10-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">my-copy-buffer</span> <span style="color: #70c0b1;">()</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">interactive</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>get-buffer-create <span style="color: #70c0b1;">"mybuffer"</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span>copy-to-buffer <span style="color: #70c0b1;">"mybuffer"</span> <span style="color: #e7c547;">(</span>point-min<span style="color: #e7c547;">)</span> <span style="color: #e7c547;">(</span>point-max<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2ce56cb" class="outline-3">
<h3 id="org2ce56cb"><span class="section-number-3">1.11.</span> 修复</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-org0a324ce" class="outline-4">
<h4 id="org0a324ce"><span class="section-number-4">1.11.1.</span> 修复 flyspell-mode 报错 Can’t find Hunspell dictionary</h4>
<div class="outline-text-4" id="text-1-11-1">
<p>
安装 <code>ispell</code> 即可
由于 <code>hunspell</code> 较为麻烦暂时不考虑使用
</p>
</div>
</div>



<div id="outline-container-org2bc2623" class="outline-4">
<h4 id="org2bc2623"><span class="section-number-4">1.11.2.</span> 修复 org 模式下的代码执行</h4>
<div class="outline-text-4" id="text-1-11-2">
<p>
purcell 解决了该问题
</p>
</div>
</div>


<div id="outline-container-org12ec72f" class="outline-4">
<h4 id="org12ec72f"><span class="section-number-4">1.11.3.</span> 修复 org-mode 以外的 evil-tab</h4>
<div class="outline-text-4" id="text-1-11-3">
<p>
由于上次的配置干扰了其他的模式下 evil tab 的使用(如编辑代码时多按了一个 tab)
<a href="daily/221202.html#ID-9ea9d1ae-b443-4259-af78-ae86bda9d5bc">配置evil 正常模式下 org TAB</a>
测试当前主模式代码:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">when</span> <span style="color: #70c0b1;">(</span>memq major-mode <span style="color: #b9ca4a;">'</span><span style="color: #e7c547;">(</span>org-mode<span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">progn</span> <span style="color: #e7c547;">(</span>message <span style="color: #70c0b1;">"hello"</span><span style="color: #e7c547;">)</span><span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
</pre>
</div>
<p>
替换配置文件:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span><span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">my/evil-org-tab</span> <span style="color: #70c0b1;">()</span>
  <span style="color: #c397d8;">"Run org-cycle When in org-mode "</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">interactive</span><span style="color: #70c0b1;">)</span>
  <span style="color: #70c0b1;">(</span><span style="color: #b9ca4a;">when</span> <span style="color: #e7c547;">(</span>memq major-mode <span style="color: #b9ca4a;">'</span><span style="color: #b9ca4a;">(</span>org-mode<span style="color: #b9ca4a;">)</span><span style="color: #e7c547;">)</span>
    <span style="color: #969896; font-style: italic;">;;;</span><span style="color: #969896; font-style: italic;">(progn (message "hello"))</span>
    <span style="color: #e7c547;">(</span>org-cycle<span style="color: #e7c547;">)</span>
    <span style="color: #70c0b1;">)</span>
  <span style="color: #eaeaea;">)</span>
<span style="color: #eaeaea;">(</span>define-key evil-normal-state-map <span style="color: #70c0b1;">(</span>kbd <span style="color: #70c0b1;">"&lt;tab&gt;"</span><span style="color: #70c0b1;">)</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">my/evil-org-tab</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org8cdabdf" class="outline-4">
<h4 id="org8cdabdf"><span class="section-number-4">1.11.4.</span> 修复 prog-mode 下 yas 功能</h4>
<div class="outline-text-4" id="text-1-11-4">
<p>
由于在沙盒内测试并无异常
经过逐个关闭 minor mode 测试后
得出冲突的模式:
</p>
<blockquote>
<p>
Symbol-Overlay minor mode
</p>
</blockquote>
<p>
已经向 <code>symbol-overlay</code> 提交 <a href="https://github.com/wolray/symbol-overlay/issues/92">issues</a>
</p>
</div>
<div id="outline-container-org835894b" class="outline-5">
<h5 id="org835894b">解决方案</h5>
<div class="outline-text-5" id="text-org835894b">
<p>
通过修改 <code>prog-mode-hook</code>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #eaeaea;">(</span>remove-hook <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">prog-mode-hook</span> <span style="color: #b9ca4a;">'</span><span style="color: #7aa6da;">symbol-overlay-mode</span><span style="color: #eaeaea;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org4b99cff" class="outline-4">
<h4 id="org4b99cff"><span class="section-number-4">1.11.5.</span> 修复 org-transclusion 报错 No content found with "id:</h4>
<div class="outline-text-4" id="text-1-11-5">
<p>
参考: <a href="https://github.com/nobiot/org-transclusion/issues/138">issues/138</a> .
通过执行 <code>M-x org-roam-update-org-id-locations</code> 更新 roam 就能正常使用.
</p>
</div>
</div>


<div id="outline-container-orgcb6e6cb" class="outline-4">
<h4 id="orgcb6e6cb"><span class="section-number-4">1.11.6.</span> 修复 pyim 在 prog-mode 下的bug</h4>
<div class="outline-text-4" id="text-1-11-6">
<p>
经过测试禁用了 <code>symbol-overlay</code> 后不再出现输入框消失和输入字符出现问题了.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">&#20316;&#32773;: <a href="https://xiliuya.github.io/">xiliuya</a></p>
<p class="date">Created: 2023-01-02 一 22:43</p>
</div>
</body>
</html>